CREATE TABLE tmpContributions (
	tmpContribution_id		serial primary key,
	s_date	 				date,
	e_date					date,
	CNAME					varchar(240),
	CRegFee					real,
	amount					real[31]
);

INSERT INTO tmpContributions (s_date, CNAME, CRegFee, amount) VALUES
('2017-07-01', 'ASBETA ALIBASI MALENGE', 300, '{30,30,30,30,30,30,30,70,70,70,70,40,40,40,40,40,40,40,40,40,40,40,40,40,40,30,30,30,30,30,30}'),
('2017-07-01', 'ATAMBA CYNTHIA', 300, '{30,30,30,30,55,55,55,55,55,55,55,30,30,30,30,30,30,30,30,30,30,55,55,55,55,55,100,30,30,30,30}'),
('2017-07-01', 'BEATRICE KAVAI ASELI', 300, '{30,30,30,30,55,55,55,55,55,55,55,30,30,30,30,30,30,30,30,30,30,55,55,55,55,55,55,55,55,55,90}'),
('2017-07-01', 'BEVERLYNE MILOYO', 300, '{30,30,30,30,55,55,55,55,55,55,55,30,30,30,30,30,30,30,30,30,30,40,40,40,40,60,30,30,30,30,30}'),
('2017-07-01', 'BRENDA MWANISA', 300, '{30,30,30,30,55,55,55,55,55,30,30,30,30,30,30,30,30,30,30,30,30,55,55,55,55,55,30,30,30,30,30}'),
('2017-07-01', 'BRIGHT NGAIRA MALEKWA ', 300, '{30,30,30,30,50,50,50,50,50,55,55,30,30,30,30,30,30,30,30,30,30,40,40,40,40,30,30,30,30,30,30}'),
('2017-07-01', 'CECIL MILA BARRY', 300, '{30,30,30,30,50,50,50,50,50,55,55,30,30,30,30,30,30,30,30,30,30,55,55,55,55,55,30,30,30,30,30}'),
('2017-07-01', 'CHAHILU VINCENT', 300, '{30,30,30,30,50,50,50,50,50,30,30,30,30,30,30,30,30,30,30,30,30,60,45,60,60,60,30,30,30,30,30}'),
('2017-08-01', 'ASBETA ALIBASI MALENGE', 300, '{30,30,30,30,30,30,30,70,70,70,70,40,40,40,40,40,40,40,40,40,40,40,40,40,40,30,30,30,30,30,30}'),
('2017-08-01', 'ATAMBA CYNTHIA', 300, '{30,30,30,30,55,55,55,55,55,55,55,30,30,30,30,30,30,30,30,30,30,55,55,55,55,55,100,30,30,30,30}'),
('2017-08-01', 'BEATRICE KAVAI ASELI', 300, '{30,30,30,30,55,55,55,55,55,55,55,30,30,30,30,30,30,30,30,30,30,55,55,55,55,55,55,55,55,55,90}'),
('2017-08-01', 'BEVERLYNE MILOYO', 300, '{30,30,30,30,55,55,55,55,55,55,55,30,30,30,30,30,30,30,30,30,30,40,40,40,40,60,30,30,30,30,30}'),
('2017-08-01', 'BRENDA MWANISA', 300, '{30,30,30,30,55,55,55,55,55,30,30,30,30,30,30,30,30,30,30,30,30,55,55,55,55,55,30,30,30,30,30}'),
('2017-08-01', 'BRIGHT NGAIRA MALEKWA ', 300, '{30,30,30,30,50,50,50,50,50,55,55,30,30,30,30,30,30,30,30,30,30,40,40,40,40,30,30,30,30,30,30}'),
('2017-08-01', 'CECIL MILA BARRY', 300, '{30,30,30,30,50,50,50,50,50,55,55,30,30,30,30,30,30,30,30,30,30,55,55,55,55,55,30,30,30,30,30}'),
('2017-08-01', 'CHAHILU VINCENT', 300, '{30,30,30,30,50,50,50,50,50,30,30,30,30,30,30,30,30,30,30,30,30,60,45,60,60,60,30,30,30,30,30}'),
('2017-08-01', 'CHARITY MUTHONI MWINGA', 300, '{30,30,30,30,50,50,50,50,50,30,30,30,30,30,30,30,30,30,30,30,30,50,50,50,50,50,50,50,50,50,50}'),
('2017-08-01', 'CHRISOSTIM WERE KHAMALA', 300, '{30,30,30,30,55,55,55,55,30,30,30,30,30,30,55,55,55,30,40,40,40,55,55,55,55,55,55,55,55,55,90}'),
('2017-08-01', 'CHRISTINE ROSE MUTHENGI', 300, '{30,30,30,30,30,55,55,55,55,55,55,55,55,55,55,55,55,40,40,40,40,55,55,55,55,55,55,55,55,55,90}'),
('2017-08-01', 'CYRILLA ANNE SHIYAYO MAKATIANI', 300, '{30,30,30,30,30,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,30,30,30,30}'),
('2017-08-01', 'CYRIUS NGAIRA LILECHI', 300, '{30,30,30,30,30,55,55,55,55,55,55,55,55,55,55,55,55,30,30,30,30,60,45,60,60,60,30,30,30,30,30}'),
('2017-08-01', 'DALTON CHEGERO', 300, '{30,30,30,30,30,55,55,55,55,55,55,55,55,55,55,55,55,30,30,30,30,60,45,60,60,60,30,30,30,30,30}'),
('2017-08-01', 'DENNIS ALUCHULA OBUNYAKHA', 300, '{30,30,30,60,60,55,55,55,55,55,55,55,55,55,55,55,55,30,30,30,30,60,45,60,60,60,30,30,30,30,30}'),
('2017-09-01', 'ASBETA ALIBASI MALENGE', 300, '{30,30,30,30,30,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,30,30,30,30,30,30,0}'),
('2017-09-01', 'ATAMBA CYNTHIA', 300, '{30,30,30,30,30,55,55,55,55,55,55,55,55,55,55,55,30,30,30,30,30,100,100,100,100,100,100,30,30,30,0}'),
('2017-09-01', 'BEATRICE KAVAI ASELI', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,80,80,80,80,80,90,90,90,0}'),
('2017-09-01', 'BEVERLYNE MILOYO', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'BRENDA MWANISA', 300, '{30,30,30,40,40,40,40,40,40,40,40,40,40,40,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'BRIGHT NGAIRA MALEKWA ', 300, '{30,30,30,30,30,45,45,45,45,45,70,70,70,70,70,70,70,70,70,45,45,45,45,45,30,30,30,30,30,30,0}'),
('2017-09-01', 'CECIL MILA BARRY', 300, '{30,30,30,40,40,40,40,40,40,40,40,40,40,40,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'CHAHILU VINCENT', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'CHARITY MUTHONI MWINGA', 300, '{50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,0}'),
('2017-09-01', 'CHRISOSTIM WERE KHAMALA', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,30,30,90,90,90,90,90,0}'),
('2017-09-01', 'CHRISTINE ROSE MUTHENGI', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,80,80,80,80,80,90,90,90,0}'),
('2017-09-01', 'CYRILLA ANNE SHIYAYO MAKATIANI', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,55,55,55,30,30,30,0}'),
('2017-09-01', 'CYRIUS NGAIRA LILECHI', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'DALTON CHEGERO', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'DENNIS ALUCHULA OBUNYAKHA', 300, '{30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'DONALD MUDAKI LOGOVA', 300, '{30,30,30,30,30,30,55,55,55,55,55,55,55,80,80,80,80,80,80,80,80,80,80,80,80,80,80,90,90,90,0}'),
('2017-09-01', 'DORTA ADIRA MALEKWA', 300, '{30,30,30,30,30,30,30,30,30,30,70,70,70,80,80,80,80,80,80,80,80,80,80,80,80,80,80,30,30,30,0}'),
('2017-09-01', 'DOUGLAS ADOLWA', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,45,45,45,45,45,45,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'EDGAR ASAVA KEVERENGE', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,30,30,90,90,90,90,90,0}'),
('2017-09-01', 'ELAMWENYA IMINZA LUCY', 300, '{30,30,30,40,40,40,40,40,40,40,40,40,40,40,30,30,30,30,30,30,30,30,73,55,55,55,55,30,30,30,0}'),
('2017-09-01', 'ERICK IKOLOMAN MAKATIANI', 300, '{30,30,30,40,40,40,40,40,40,40,40,40,40,40,30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,30,0}'),
('2017-09-01', 'Esther Nyonje Akengo', 300, '{40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,0}'),
('2017-09-01', 'EVALYN MUHAMBE', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,45,45,45,45,45,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'EVANS CHEGERO OBUNYU', 300, '{30,30,30,30,30,30,55,55,55,55,55,55,55,80,80,80,80,80,80,80,80,80,80,80,80,80,80,90,90,90,0}'),
('2017-09-01', 'FAITH KAMAGA ADIRA', 300, '{30,30,30,30,30,45,45,45,45,45,70,70,70,70,70,70,70,70,70,45,45,45,45,45,30,30,30,30,30,30,0}'),
('2017-09-01', 'FELIX JUMBA', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'FLORENCE GIYA KAGEHA', 300, '{30,30,30,30,30,30,30,30,30,30,70,70,70,80,80,80,80,80,80,80,80,80,80,80,80,80,80,30,30,30,0}'),
('2017-09-01', 'FLORENCE LIBESE NAMBENYA', 300, '{30,30,30,30,30,30,30,30,30,30,70,70,70,80,80,80,80,80,80,80,80,80,80,80,80,80,80,30,30,30,0}'),
('2017-09-01', 'FRANCIS KIDEMI', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'GADAFI GAMSA JUMA', 300, '{30,30,30,30,30,30,30,45,45,45,45,45,45,45,45,45,45,45,45,45,45,30,30,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'GILBERT SHIKOLI MAKATIANI', 300, '{30,30,30,30,30,30,30,30,30,30,70,70,70,80,80,80,80,80,80,80,80,80,80,80,80,80,80,30,30,30,0}'),
('2017-09-01', 'HUMPHREY ASUZA ', 300, '{30,30,30,30,30,30,30,45,45,45,45,45,45,45,45,45,45,45,45,45,45,30,30,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'IDI RAMADHANI KIBULELIA', 300, '{30,30,30,30,30,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,30,30,30,30,30,30,0}'),
('2017-09-01', 'ISINGA SAMMY', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,100,100,100,100,30,30,30,0}'),
('2017-09-01', 'JACK KEVERENGE', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,45,45,45,45,45,45,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'JOHN MUSALIA MTAFUTA', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,30,30,90,90,90,90,90,0}'),
('2017-09-01', 'JOSEPHINE KADESA NYANDO', 300, '{30,30,30,30,30,45,45,45,45,45,70,70,70,70,70,70,70,70,70,45,45,45,45,45,30,30,30,30,30,30,0}'),
('2017-09-01', 'JOSEPHINE MAKATIANI NNANDI', 300, '{30,30,30,30,30,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'JOYCE ANN JUMBA', 300, '{30,30,30,30,30,30,55,55,55,55,55,55,55,80,80,80,80,80,80,80,80,80,80,80,80,80,80,90,90,90,0}'),
('2017-09-01', 'JUMBA MALEYA HUDSON', 300, '{30,30,30,30,30,30,55,55,55,55,55,55,55,80,80,80,80,80,80,80,80,80,80,80,80,80,80,90,90,90,0}'),
('2017-09-01', 'Justice Robbian Mutungu', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'KIDIYA KADUVANE VIOLET', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,80,80,80,80,80,30,30,30,0}'),
('2017-09-01', 'KNIGHT KASIDI ASIGE', 300, '{30,30,30,30,30,55,55,55,55,55,55,55,55,55,55,55,30,30,30,30,30,100,100,100,100,100,100,30,30,30,0}'),
('2017-09-01', 'MARGARET MUGONDA', 300, '{30,30,30,30,30,30,30,30,30,30,70,70,70,80,80,80,80,80,80,80,80,80,80,80,80,80,80,30,30,30,0}'),
('2017-09-01', 'MARIA ATIAMUGA KISUTSA', 300, '{30,30,30,30,30,55,55,55,55,55,55,55,55,55,55,55,30,30,30,30,30,100,100,100,100,100,100,30,30,30,0}'),
('2017-09-01', 'MARTIN OPIYO GWAMBO', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,100,100,100,100,30,30,30,0}'),
('2017-09-01', 'MARY MURANGI RUTERE', 300, '{30,30,30,30,30,30,30,30,30,30,70,70,70,80,80,80,80,80,80,80,80,80,80,80,80,80,80,30,30,30,0}'),
('2017-09-01', 'MASHETI CONRAD', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,100,100,100,100,30,30,30,0}'),
('2017-09-01', 'MCFARLEN KIVAIRU NGERESO', 300, '{30,30,30,40,40,40,40,40,40,40,40,40,40,40,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'MIHESO MAKATIANI CEDRIC', 300, '{30,30,30,30,45,30,55,55,55,55,55,55,55,80,80,80,80,80,80,80,80,80,80,80,80,80,80,90,90,90,0}'),
('2017-09-01', 'MONICA MUTUNGU KONZORO', 300, '{30,30,30,30,30,45,45,45,45,45,70,70,70,70,70,70,70,70,70,45,45,45,45,45,30,30,30,30,30,30,0}'),
('2017-09-01', 'MOSES KALWALE', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'MUKHUNJI MAKATIANI CYRIL', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,30,30,90,90,90,90,90,0}'),
('2017-09-01', 'MUTANGE MMBONE ROSE', 300, '{30,30,30,30,30,55,55,55,55,55,55,55,55,55,55,55,30,30,30,30,30,100,100,100,100,100,100,30,30,30,0}'),
('2017-09-01', 'MWALIMU ENDEGURE', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'NAIGHT KAVOSA ONZERE', 300, '{30,30,30,30,30,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,30,30,30,30,30,30,0}'),
('2017-09-01', 'NOAH DEMESI MWIRUKI', 300, '{30,30,30,30,30,30,30,30,30,30,70,70,70,80,80,80,80,80,80,80,80,80,80,80,80,80,80,30,30,30,0}'),
('2017-09-01', 'PETER OTIENO OKOTH', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'ROSE KEDOGO MAHONGA', 300, '{30,30,30,30,30,30,30,30,30,30,70,70,70,80,80,80,80,80,80,80,80,80,80,80,80,80,80,30,30,30,0}'),
('2017-09-01', 'ROSEMARY NYAMBURA KARIUKI', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,30,30,90,90,90,90,90,0}'),
('2017-09-01', 'SAKINA RABEKA ABDALLA', 300, '{30,30,30,30,30,30,30,30,30,30,70,70,70,70,70,70,70,70,70,30,30,30,30,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'SAMMY ANANDA MUDIANGA', 300, '{30,30,30,30,30,30,30,45,45,45,45,45,45,45,45,45,45,45,45,45,45,30,30,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'Samwel Simiyu Wanyama', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,90,30,30,30,30,30,30,30,30,30,30,30,55,55,55,30,30,30,0}'),
('2017-09-01', 'SARAH KAHUGANE LLUMADEDE', 300, '{30,30,30,30,30,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,30,30,30,30,30,30,0}'),
('2017-09-01', 'SCHWAZZENNIGAR NEWTON CHAGWI', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'SHARON AKINYI ODHIAMBO', 300, '{30,30,30,30,30,55,30,30,30,30,30,30,55,55,55,55,30,30,30,30,30,100,100,30,30,30,100,30,30,30,0}'),
('2017-09-01', 'THOMAS OYONDI KAVAI', 300, '{30,30,30,30,30,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,30,30,30,30,30,30,30,0}'),
('2017-09-01', 'VIOLET MURENGEKA', 300, '{30,30,30,30,30,30,30,30,30,30,60,60,60,60,60,60,60,60,60,60,60,60,45,60,60,60,30,30,30,30,0}'),
('2017-09-01', 'WILLIAM LIKOBELE MAKATIANI', 300, '{30,30,30,30,30,30,30,30,30,30,30,30,30,30,80,80,80,80,80,80,80,80,80,30,30,90,90,90,90,90,0}');

UPDATE tmpContributions SET e_date = s_date + '1 month'::interval - '1 day'::interval;


INSERT INTO account_activity (deposit_account_id, activity_type_id, activity_frequency_id,
	activity_status_id, currency_id, entity_id, org_id, activity_date, value_date, account_credit)
SELECT deposit_account_id, 4, 1, 1, 1, 0, 0,
	a.period_day, a.period_day, b.amount[EXTRACT(DAY FROM a.period_day)::integer]
FROM (SELECT tmpContribution_id, generate_series(s_date, e_date, '1 day')::date as period_day
FROM tmpcontributions) a
	INNER JOIN tmpcontributions b ON a.tmpContribution_id = b.tmpContribution_id
	INNER JOIN members ON b.cname = members.member_name
	INNER JOIN deposit_accounts ON members.entity_id = deposit_accounts.entity_id;
	
	